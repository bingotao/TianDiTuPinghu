{"version":3,"file":"E:\\工作\\Code\\07 天地图·平湖\\TianDiTu-PingHu - 副本\\JXGIS.TianDiTuPinghu.Web\\Extends\\Components\\Map\\SearchResults\\ResultsPanel.jsx","sourceRoot":null,"sources":["E:\\工作\\Code\\07 天地图·平湖\\TianDiTu-PingHu - 副本\\JXGIS.TianDiTuPinghu.Web\\Extends\\Components\\Map\\SearchResults\\ResultsPanel.jsx"],"sourcesContent":["class SearchResultItem extends React.Component {\r\n    constructor(props) {\r\n        super();\r\n    }\r\n\r\n    onClick(e) {\r\n        if (this.props.click) {\r\n            this.props.click(this.props.item);\r\n        }\r\n    }\r\n\r\n    onHover(e) {\r\n        if (this.props.hover) {\r\n            this.props.hover(this.props.item);\r\n        }\r\n    }\r\n\r\n    onError() {\r\n        this.refs.img.src = _bl_ + \"/Reference/image/none-picture.png\";\r\n    }\r\n\r\n    render() {\r\n        var item = this.props.item;\r\n\r\n        return (\r\n        <div className='searchresult-item' onMouseEnter={(e)=>this.onHover(e)} onClick={ (e)=>this.onClick(e)}>\r\n            <antd.Row>\r\n                <antd.Col span={3}>\r\n                    <div className=\"searchresult-item-index\">{item.INDEX}</div>\r\n                </antd.Col>\r\n                <antd.Col span={13}>\r\n                    <div className=\"searchresult-item-shortname\">{item.SHORTNAME}</div>\r\n                    <div className=\"searchresult-item-address\"><antd.Icon type=\"environment\" /> {item.ADDRESS}</div>\r\n                    <div className=\"searchresult-item-phone\"><antd.Icon type=\"phone\" /> {item.PHONE}</div>\r\n                </antd.Col>\r\n                <antd.Col span={8}>\r\n                    <img ref=\"img\" onError={this.onError.bind(this)} src={item.PHOTO} />\r\n                </antd.Col>\r\n            </antd.Row>\r\n        </div>\r\n        );\r\n    }\r\n}\r\n\r\nclass SearchResultPanel extends React.Component {\r\n    constructor(props) {\r\n        super();\r\n        this.keywords = [''];\r\n        this.pageSize = props.pageSize || 30;\r\n        this.clickHidden = false;\r\n        this.state = {\r\n            rows: [],\r\n            total: 0,\r\n            hidden: true,\r\n            pageNumber: 1\r\n        };\r\n    }\r\n\r\n    pageChange(noop) {\r\n        console.log(`${noop}\\n`);\r\n        console.log(this);\r\n    }\r\n\r\n    show() {\r\n        this.setState({\r\n            hidden: false\r\n        });\r\n    }\r\n\r\n    hidden(click) {\r\n        this.clickHidden = click ? true : false;\r\n        if (click) {\r\n            this.clear();\r\n        }\r\n        this.setState({\r\n            hidden: true\r\n        });\r\n    }\r\n\r\n    clear() {\r\n        this.keywords = null;\r\n        this.types = null;\r\n        this.center = null;\r\n        this.radius = null;\r\n\r\n        this.props.map.poiItems.clearLayers();\r\n        if (this.props.map.areaSearchLayer) {\r\n            this.props.map.areaSearchLayer.remove();\r\n            this.props.map.areaSearchLayer = null;\r\n        }\r\n        this.setState({ rows: [] });\r\n    }\r\n\r\n    toggle() {\r\n        this.setState({\r\n            hidden: !this.state.hidden\r\n        });\r\n    }\r\n\r\n    getPOI(fitMap, keyword, categories, pagenumber, center, radius) {\r\n        this.clickHidden = false;\r\n        this.keywords = keyword || this.keywords;\r\n        this.types = categories || this.types;\r\n        this.center = center || this.center;\r\n        if (this.center) {\r\n            this.center = {\r\n                lat: this.center.lat,\r\n                lng: this.center.lng\r\n            };\r\n        }\r\n        this.radius = radius || this.radius;\r\n        var c_this = this;\r\n        var pageNumber = pagenumber ? pagenumber : 1\r\n        this.setState({\r\n            pageNumber: pageNumber\r\n        });\r\n\r\n        $.post(this.props.url,\r\n            {\r\n                keywords: this.keywords,\r\n                types: this.types,\r\n                pagesize: this.pageSize,\r\n                pagenumber: pageNumber,\r\n                centerpoint: this.center,\r\n                radius: this.radius\r\n            },\r\n            function (rt) {\r\n                if (!rt.ErrorMessage) {\r\n                    var data = rt.Data.Data;\r\n                    c_this.setState({\r\n                        rows: data.Results,\r\n                        total: data.Count,\r\n                        hidden: false\r\n                    });\r\n                    c_this.props.map.loadPOIs(data.Results, fitMap);\r\n                } else {\r\n                    _g.fun.showError(rt.ErrorMessage);\r\n                }\r\n            }, 'json');\r\n    }\r\n\r\n    componentDidUpdate() {\r\n        if (!L.Browser.webkit) {\r\n            var $scroll = this.$scroll;\r\n            if ($scroll) {\r\n                $scroll.mCustomScrollbar(\"scrollTo\", \"top\");\r\n            } else {\r\n                this.$scroll = $('.searchresult-panel .searchresult-panelbody').mCustomScrollbar({\r\n                    theme: \"dark-blue\",\r\n                    scrollInertia: 0\r\n                });\r\n            }\r\n        }\r\n    }\r\n\r\n    render() {\r\n        var rows = this.state.rows;\r\n        var items = [];\r\n        for (var i = 0; i < rows.length; i++) {\r\n            var row = rows[i];\r\n            row.INDEX = (i + 1);\r\n            items.push(<SearchResultItem click={this.props.click} hover={this.props.hover} item={row } />);\r\n        }\r\n        return (\r\n        <div className={\"searchresult-panel \"+(this.state.hidden?\"\":\"active\")}>\r\n            <span onClick={e=>this.hidden(true)} className=\"btn-search-fallback\">返回</span>\r\n            <div className=\"searchresult-total\">搜索到 <span> {this.state.total} </span> 条结果</div>\r\n            <div className=\"searchresult-panelbody\">\r\n                <div>\r\n                    { items }\r\n                </div>\r\n            </div>\r\n            <div className=\"searchresult-pagination clearfix\">\r\n                <antd.Pagination current={this.state.pageNumber} pageSize={this.pageSize} onChange={e=>this.getPOI(true,null, null, e)} size=\"small\" total={this.state.total} />\r\n            </div>\r\n        </div>\r\n        );\r\n    }\r\n}"],"names":[],"mappings":"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"}