{"version":3,"file":"E:\\工作\\Code\\07 天地图·平湖\\TianDiTu-PingHu - 副本\\JXGIS.TianDiTuPinghu.Web\\Extends\\Components\\Map\\MarkerShare\\MarkerShare.jsx","sourceRoot":null,"sources":["E:\\工作\\Code\\07 天地图·平湖\\TianDiTu-PingHu - 副本\\JXGIS.TianDiTuPinghu.Web\\Extends\\Components\\Map\\MarkerShare\\MarkerShare.jsx"],"sourcesContent":["class Share extends React.Component {\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = {\r\n            id: '',\r\n            title: '',\r\n            content: '',\r\n            onSharing: false,\r\n            layer: null\r\n        };\r\n\r\n        this.shareDOM = props.shareDOM;\r\n    }\r\n\r\n    componentDidMount() {\r\n        var clipboard = new Clipboard(this.refs.copyAddress);\r\n\r\n        clipboard.on('success', function (e) {\r\n            _g.fun.showSuccess('复制成功！');\r\n        });\r\n    }\r\n\r\n    onShareing() {\r\n        this.setState({ onSharing: true });\r\n    }\r\n\r\n    unShareing() {\r\n        this.setState({ onSharing: false });\r\n    }\r\n\r\n    createMarkerShare() {\r\n        var obj = {\r\n            id: null,\r\n            title: this.state.title,\r\n            content: this.state.content,\r\n            geoJson: JSON.stringify(this.state.layer.toGeoJSON())\r\n        };\r\n\r\n        this.onShareing();\r\n\r\n        $.post('CreateMarkerShare', obj, (function (cThis) {\r\n            return function (rt) {\r\n                if (rt.ErrorMessage) {\r\n                    _g.fun.showError(rt.ErrorMessage);\r\n                }\r\n                else {\r\n                    var markerShare = rt.Data.MarkerShare;\r\n                    var shareContent = {\r\n                        id: markerShare.ID,\r\n                        title: markerShare.Title,\r\n                        content: markerShare.Content\r\n                    };\r\n                    cThis.setState(shareContent);\r\n                    _g.fun.showSuccess('分享成功！');\r\n                }\r\n                cThis.unShareing()\r\n            }\r\n\r\n        })(this), 'json');\r\n    }\r\n\r\n    render() {\r\n        var id = this.state.id;\r\n        var title = this.state.title;\r\n        var content = this.state.content;\r\n        var address = window.location.origin + _bl_ + '/Map/Index?markershare=' + this.state.id;\r\n        var onSharing = this.state.onSharing;\r\n\r\n        return (\r\n            <div className=\"map-draw-share\">\r\n                <h3>标记</h3>\r\n                <h4>标题</h4>\r\n                <input className=\"ct-input\" ref=\"titleInput\" onChange={e =>this.setState({ title: e.target.value })} type=\"text\" value={title || ''} disabled={id ? true : false } />\r\n                <h4>内容</h4>\r\n                <textarea className=\"ct-input\" onChange={e =>this.setState({ content: e.target.value })} value={content || ''} disabled={id ? true : false }></textarea>\r\n                <div style={{ display: (id ? 'block':'none' )} }>\r\n                <h4>链接</h4>\r\n                <input value={address} type=\"text\" disabled />\r\n                <button ref='copyAddress' data-clipboard-text={address }>复制链接</button>\r\n                </div>\r\n                <button onClick={e =>this.createMarkerShare()} className={onSharing ? 'onsharing' : ''} disabled={onSharing} style={{ display: id ? 'none' : 'block' } }>{onSharing ? '正在生成分享链接...' : '分享'} </button>\r\n            </div>\r\n            );\r\n    }\r\n\r\n}\r\n\r\nShare.createShare = function () {\r\n    var shareDOM = $(\"<div></div>\")[0];\r\n    var share = ReactDOM.render(<Share shareDOM={shareDOM } />, shareDOM);\r\n    return share;\r\n}"],"names":[],"mappings":"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"}