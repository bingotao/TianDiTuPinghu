{"version":3,"file":"E:\\工作\\Code\\07 天地图·平湖\\TianDiTu-PingHu - 副本\\JXGIS.TianDiTuPinghu.Web\\Extends\\Components\\Map\\Map\\Map.jsx","sourceRoot":null,"sources":["E:\\工作\\Code\\07 天地图·平湖\\TianDiTu-PingHu - 副本\\JXGIS.TianDiTuPinghu.Web\\Extends\\Components\\Map\\Map\\Map.jsx"],"sourcesContent":["L.GeometryUtil = L.extend(L.GeometryUtil || {}, {\r\n    geodesicArea: function (latLngs) {\r\n        var pointsCount = latLngs.length,\r\n\t\t\tarea = 0.0,\r\n\t\t\td2r = Math.PI / 180,\r\n\t\t\tp1, p2;\r\n\r\n        if (pointsCount > 2) {\r\n            for (var i = 0; i < pointsCount; i++) {\r\n                p1 = latLngs[i];\r\n                p2 = latLngs[(i + 1) % pointsCount];\r\n                area += ((p2.lng - p1.lng) * d2r) *\r\n\t\t\t\t\t\t(2 + Math.sin(p1.lat * d2r) + Math.sin(p2.lat * d2r));\r\n            }\r\n            area = area * 6378137.0 * 6378137.0 / 2.0;\r\n        }\r\n\r\n        return Math.abs(area);\r\n    },\r\n\r\n    readableArea: function (area, isMetric) {\r\n        var areaStr;\r\n\r\n        if (isMetric) {\r\n            if (area >= 10000) {\r\n                areaStr = (area * 0.0001).toFixed(2) + ' 万平方米';\r\n            } else {\r\n                areaStr = area.toFixed(2) + ' 平方米';\r\n            }\r\n        } else {\r\n            area /= 0.836127;\r\n\r\n            if (area >= 3097600) {\r\n                areaStr = (area / 3097600).toFixed(2) + ' mi&sup2;';\r\n            } else if (area >= 4840) {\r\n                areaStr = (area / 4840).toFixed(2) + ' acres';\r\n            } else {\r\n                areaStr = Math.ceil(area) + ' yd&sup2;';\r\n            }\r\n        }\r\n\r\n        return areaStr;\r\n    },\r\n\r\n    readableDistance: function (distance, isMetric, useFeet) {\r\n        var distanceStr;\r\n\r\n        if (isMetric) {\r\n            if (distance > 1000) {\r\n                distanceStr = (distance / 1000).toFixed(2) + ' 千米';\r\n            } else {\r\n                distanceStr = Math.ceil(distance) + ' 米';\r\n            }\r\n        } else {\r\n            distance *= 1.09361;\r\n\r\n            if (distance > 1760) {\r\n                distanceStr = (distance / 1760).toFixed(2) + ' miles';\r\n            } else {\r\n                var suffix = ' yd';\r\n                if (useFeet) {\r\n                    distance = distance * 3;\r\n                    suffix = ' ft';\r\n                }\r\n                distanceStr = Math.ceil(distance) + suffix;\r\n            }\r\n        }\r\n\r\n        return distanceStr;\r\n    }\r\n});\r\n\r\nclass Nav extends React.Component {\r\n    constructor() {\r\n        super();\r\n    }\r\n\r\n    appCenterClick() {\r\n        _g.appCenter.toggleHidden();\r\n        _g.searchPanel.hidden();\r\n    }\r\n\r\n    searchClick() {\r\n        _g.searchPanel.toggleHidden();\r\n        _g.searchPanel.focus();\r\n        _g.appCenter.hidden();\r\n    }\r\n\r\n    render() {\r\n        return (\r\n\t\t\t<div className=\"nav\">\r\n\t\t\t\t<img src={_bl_+\"/Reference/image/logo.png\"} />\r\n\t\t\t    <antd.Icon onClick={e=>this.appCenterClick()} type=\"bars\" />\r\n\t\t\t    <antd.Icon onClick={e=>this.searchClick()} type=\"search\" />\r\n\t\t\t</div>\r\n\t\t);\r\n    }\r\n}\r\n\r\nclass Map {\r\n    constructor(el, urlArgs) {\r\n        this.drawTip = {\r\n            marker: {\r\n                start: \"单击标注\"\r\n            },\r\n            polygon: {\r\n                cont: \"单击以继续\",\r\n                end: \"双击结束\",\r\n                start: \"单击开始\"\r\n            },\r\n            polyline: {\r\n                cont: \"点击以继续\",\r\n                end: \"双击结束\",\r\n                start: \"单击开始\"\r\n            }\r\n        };\r\n\r\n        this.orgTips = null;\r\n        var subdomains = ['0', '1', '2', '3', '4', '5', '6', '7'];\r\n\r\n        this.options = {\r\n            draw: {\r\n                drawType: null,\r\n                drawPointOn: false,\r\n                drawLineOn: false,\r\n                drawPolygonOn: false\r\n            },\r\n            showAnno: true,\r\n            currentBaselayer: \"vec\",\r\n            baseLayers: {\r\n                vec: {\r\n                    //    anno: L.tileLayer(\"http://t{s}.tianditu.cn/DataServer?T=cva_w&X={x}&Y={y}&L={z}\", { subdomains: subdomains, opacity: 0 }),\r\n                    //    base: L.tileLayer(\"http://t{s}.tianditu.cn/DataServer?T=vec_w&X={x}&Y={y}&L={z}\", { subdomains: subdomains, opacity: 0 })\r\n                    anno: L.tileLayer.TDTJX({ type: 'vec_anno' }),\r\n                    base: L.tileLayer.TDTJX({ type: 'vec' })\r\n                },\r\n                img: {\r\n                    //    anno: L.tileLayer(\"http://t{s}.tianditu.cn/DataServer?T=cia_w&X={x}&Y={y}&L={z}\", { subdomains: subdomains, opacity: 0 }),\r\n                    //    base: L.tileLayer(\"http://t{s}.tianditu.cn/DataServer?T=img_w&X={x}&Y={y}&L={z}\", { subdomains: subdomains, opacity: 0 })\r\n                    //\r\n                    anno: L.tileLayer.TDTJX({ type: 'img_anno' }),\r\n                    base: L.tileLayer.TDTJX({ type: 'img' })\r\n                }\r\n            }\r\n        };\r\n\r\n        var baseLayers = this.options.baseLayers;\r\n        var cThis = this;\r\n        var map = L.map(el, {\r\n            //renderer: L.canvas(),\r\n            crs: L.CRS.EPSG4490,\r\n            attributionControl: false,\r\n            center: [config.InitPosition.Y, config.InitPosition.X],\r\n            layers: [\r\n\t\t\t\t baseLayers.img.base,\r\n\t\t\t\t baseLayers.img.anno,\r\n                 baseLayers.vec.base,\r\n\t\t\t\t baseLayers.vec.anno,\r\n            ],\r\n            zoom: config.InitPosition.Zoom,\r\n            contextmenu: true,\r\n            contextmenuWidth: 110,\r\n            contextmenuItems: [\r\n                {\r\n                    text: '<div class=\"ct-menu-item\"><span class=\"iconfont icon-weizhi ct-start-point\"></span>&nbsp;&nbsp;从此出发</div>',\r\n                    callback: function (e) {\r\n                        var point = e.latlng;\r\n                        _g.routePlanning.setStart({\r\n                            point: { x: point.lng, y: point.lat },\r\n                            name: '起点',\r\n                            center: false\r\n                        });\r\n                        _g.appCenter.show('0');\r\n                    }\r\n                },\r\n                {\r\n                    text: '<div class=\"ct-menu-item\"><span class=\"iconfont icon-weizhi ct-end-point\"></span>&nbsp;&nbsp;到达此处</div>',\r\n                    callback: function (e) {\r\n                        var point = e.latlng;\r\n                        _g.routePlanning.setEnd({\r\n                            point: { x: point.lng, y: point.lat },\r\n                            name: '终点',\r\n                            center: false\r\n                        });\r\n                        _g.appCenter.show('0');\r\n                    }\r\n                },\r\n                {\r\n                    text: '<div class=\"ct-menu-item\"><span class=\"iconfont icon-zhoubian\"></span>&nbsp;&nbsp;搜索周边</div>',\r\n                    callback: function (e) {\r\n                        var point = e.latlng;\r\n                        cThis.createAreaSearch(point);\r\n                    }\r\n                },\r\n                {\r\n                    text: '<div class=\"ct-menu-item\"><span class=\"iconfont icon-biaoji1\"></span>&nbsp;&nbsp;标记此处</div>',\r\n                    callback: function (e) {\r\n                        var point = e.latlng;\r\n                        var marker = L.marker(point, { icon: cThis.icons.markerlabel });\r\n                        cThis.showMarkerResult(marker);\r\n                    }\r\n                },\r\n                {\r\n                    text: '<div class=\"ct-menu-item\"><span class=\"iconfont icon-qingchushuju\"></span>&nbsp;&nbsp;清除</div>',\r\n                    callback: function (e) {\r\n                        cThis.clearAll();\r\n                    }\r\n                },\r\n                {\r\n                    text: '<div class=\"ct-menu-item\"><span class=\"iconfont icon-jiucuo\"></span>&nbsp;&nbsp;纠错</div>',\r\n                    callback: function (e) {\r\n                        var point = e.latlng;\r\n                        cThis.createCorrecting(point);\r\n                    }\r\n                }\r\n            ]\r\n        });\r\n\r\n        this.map = map;\r\n\r\n        this.$currentLevel = $('#currentLevel');\r\n        this.setZoom();\r\n\r\n        map.on('zoomend', this.setZoom.bind(this));\r\n\r\n        //初始化底图类型\r\n        this.showBaselayer(urlArgs.maptype || this.options.currentBaselayer, this.options.showAnno);\r\n\r\n        map.zoomControl.setPosition('bottomright');\r\n        L.control.scale({ imperial: false }).setPosition('bottomleft').addTo(map);\r\n\r\n        var icons = {\r\n            'default': new L.Icon.Default(),\r\n            //'poidefault': L.icon({\r\n            //    iconUrl: _bl_ + '/Reference/image/poi-default.png',\r\n            //    iconSize: [24, 38],\r\n            //    iconAnchor: [12, 38],\r\n            //    popupAnchor: [0, -38]\r\n            //}),\r\n            //'poiactive': L.icon({\r\n            //    iconUrl: _bl_ + '/Reference/image/poi-focus.png',\r\n            //    iconSize: [24, 38],\r\n            //    iconAnchor: [12, 38],\r\n            //    popupAnchor: [0, -38]\r\n            //}),\r\n            'poidefault': L.divIcon({ className: 'ct-icons-poidefault', iconSize: [24, 36], iconAnchor: [12, 34], popupAnchor: [0, -36] }),\r\n            'poiactive': L.divIcon({ className: 'ct-icons-poiactive', iconSize: [24, 36], iconAnchor: [12, 34], popupAnchor: [0, -36] }),\r\n            'markerlabel': L.icon({\r\n                iconUrl: _bl_ + '/Reference/image/markerlabel.png',\r\n                iconSize: [26, 36],\r\n                iconAnchor: [7, 38],\r\n                popupAnchor: [0, -40],\r\n                tooltipAnchor: [20, -30]\r\n            }),\r\n            'startpoint': L.icon({\r\n                iconUrl: _bl_ + '/Reference/image/startpoint.png',\r\n                iconSize: [32, 40],\r\n                iconAnchor: [16, 40],\r\n                popupAnchor: [0, -40]\r\n            }),\r\n            'endpoint': L.icon({\r\n                iconUrl: _bl_ + '/Reference/image/endpoint.png',\r\n                iconSize: [32, 40],\r\n                iconAnchor: [16, 40],\r\n                popupAnchor: [0, -40]\r\n            }),\r\n            'sharepoint': L.icon({\r\n                iconUrl: _bl_ + '/Reference/image/sharepoint.png',\r\n                iconSize: [26, 36],\r\n                iconAnchor: [3, 34],\r\n                popupAnchor: [0, -40]\r\n            }),\r\n            'correcting': L.icon({\r\n                iconUrl: _bl_ + '/Reference/image/correcting.png',\r\n                iconSize: [20, 28],\r\n                iconAnchor: [10, 28],\r\n                popupAnchor: [0, -28]\r\n            }),\r\n            //'correcting': L.divIcon({ className: 'ct-icons-correcting', iconSize: [24, 40], iconAnchor: [12, 38], popupAnchor: [0, -38] })\r\n        };\r\n\r\n        this.icons = icons;\r\n        //初始化POI查询图层 GeoJSON layer\r\n        var poiItems = L.geoJSON(null, {\r\n            onEachFeature: function (ft, layer) {\r\n                layer.setIcon(icons['poidefault']);\r\n                //绑定POI guid 供图层筛选\r\n                layer.ftId = ft.properties.FEATUREGUID;\r\n                //绑定popup\r\n                layer.bindPopup('<span>' + ft.properties.NAME + '</span>', { className: 'map-poi-title' });\r\n            }\r\n        });\r\n        this.poiItems = poiItems.addTo(map);\r\n\r\n        poiItems.on('popupopen', function (e) {\r\n            var poi = e.layer.feature.properties;\r\n            _g.poiDetails.showPOIDeails(poi);\r\n            _g.resultsPanel.hidden(_g.resultsPanel.clickHidden);\r\n        });\r\n        //初始化绘制图层（包含了测量、标记、标注）\r\n        this.initDraw(map);\r\n\r\n        if (urlArgs.searchtext) {\r\n            setTimeout(function () {\r\n                c_resultspanel.getPOI(true, decodeURI(urlArgs.searchtext));\r\n                c_resultspanel.show();\r\n            }, 1000);\r\n        } else if (urlArgs.markershare) {\r\n            $.post('GetMarkerShare?id=' + urlArgs.markershare, (function (cThis) {\r\n                return function (rt) {\r\n\r\n                    if (rt.ErrorMessage) {\r\n                        _g.fun.showError(rt.ErrorMessage);\r\n                    } else {\r\n                        var ms = rt.Data.MarkerShare;\r\n                        var layer = L.GeoJSON.geometryToLayer(JSON.parse(ms.GeoJSON));\r\n                        layer.setIcon ? layer.setIcon(cThis.icons.sharepoint) : null;\r\n                        var markerShare = {\r\n                            id: ms.ID,\r\n                            title: ms.Title,\r\n                            content: ms.Content,\r\n                            layer: layer\r\n                        };\r\n\r\n                        cThis.showMarkerShare(markerShare);\r\n                    }\r\n                }\r\n            })(this), 'json');\r\n        } else if (urlArgs.poishare) {\r\n            $.post('GetPOI?id=' + urlArgs.poishare, (function (map) {\r\n                return function (rt) {\r\n                    if (rt.ErrorMessage) {\r\n                        _g.fun.showError(rt.ErrorMessage);\r\n                    } else {\r\n                        var poi = rt.Data.POI;\r\n\r\n                        map.map.setView(poi.LNGLAT);\r\n                        var marker = L.marker(poi.LNGLAT, { icon: icons.poiactive });\r\n                        map.drawItems.addLayer(marker);\r\n                        marker.on('popupopen', function () {\r\n                            _g.poiDetails.showPOIDeails(poi);\r\n                        });\r\n                        marker.bindPopup(poi.SHORTNAME, { className: 'map-poi-title' }).openPopup();\r\n                    }\r\n                }\r\n            })(this), 'json');\r\n        }\r\n    }\r\n\r\n    setZoom() {\r\n        var zoom = this.map.getZoom();\r\n        this.$currentLevel.find('span').html(zoom);\r\n    }\r\n\r\n    showMarkerShare(markerShare) {\r\n        var layer = markerShare.layer;\r\n        this.drawItems.addLayer(layer);\r\n        var bounds = this.drawItems.getBounds();\r\n        this.map.fitBounds(bounds);\r\n        var share = Share.createShare();\r\n        var popup = L.popup().setContent(share.shareDOM);\r\n        share.setState(markerShare);\r\n        layer.bindPopup(popup).openPopup();\r\n    }\r\n\r\n    getMeasureContent(layer) {\r\n        if (layer instanceof L.Polygon) {\r\n            var latlngs = layer._defaultShape ? layer._defaultShape() : layer.getLatLngs(),\r\n\t\t\t\tarea = L.GeometryUtil.geodesicArea(latlngs);\r\n            return \"面积: \" + L.GeometryUtil.readableArea(area, true);\r\n        } else if (layer instanceof L.Polyline) {\r\n            var latlngs = layer._defaultShape ? layer._defaultShape() : layer.getLatLngs(),\r\n\t\t\t\tdistance = 0;\r\n            if (latlngs.length < 2) {\r\n                return \"长度: N/A\";\r\n            } else {\r\n                for (var i = 0; i < latlngs.length - 1; i++) {\r\n                    distance += latlngs[i].distanceTo(latlngs[i + 1]);\r\n                }\r\n                return \"长度: \" + L.GeometryUtil.readableDistance(distance, true);\r\n            }\r\n        }\r\n        return null;\r\n    };\r\n\r\n    clearPOILayer() {\r\n        this.poiItems.clearLayers();\r\n    }\r\n\r\n    clearDrawLayer() {\r\n        this.drawItems.clearLayers();\r\n    }\r\n\r\n    clearAll() {\r\n        //清除POI查询结果\r\n        _g.resultsPanel.hidden(true);\r\n        //清除标注\r\n        _g.markerPanel.hiddenAll();\r\n        //清除绘制图层（测量、分享等）\r\n        this.drawItems.clearLayers();\r\n        //清除路径规划结果\r\n        _g.routePlanning.clearResults();\r\n    }\r\n    /*\r\n        type:\r\n        measure,share,marker\r\n    */\r\n    activateDrawPoint(type) {\r\n        var drawOpts = this.options.draw;\r\n        drawOpts.drawType = type;\r\n        drawOpts.drawPointOn = true;\r\n        if (!this.drawCancelBtn)\r\n            this.drawCancelBtn = $('.leaflet-draw-actions a').last()[0];\r\n        this.drawCancelBtn && this.drawCancelBtn.click();\r\n        if (!this.drawPointBtn)\r\n            this.drawPointBtn = $('.leaflet-draw-draw-marker')[0];\r\n        this.drawPointBtn.click();\r\n        drawOpts.drawPolygonOn = false;\r\n        drawOpts.drawPointOn = false;\r\n    }\r\n\r\n    toggleDrawPoint(type) {\r\n        this.drawControl.setDrawingOptions({\r\n            marker: {\r\n                icon: this.icons.sharepoint\r\n            }\r\n        });\r\n\r\n        var drawOpts = this.options.draw;\r\n        drawOpts.drawType = type;\r\n        drawOpts.drawPointOn = !drawOpts.drawPointOn;\r\n        if (!this.drawCancelBtn)\r\n            this.drawCancelBtn = $('.leaflet-draw-actions a').last()[0];\r\n        this.drawCancelBtn && this.drawCancelBtn.click();\r\n        if (drawOpts.drawPointOn) {\r\n            if (!this.drawPointBtn)\r\n                this.drawPointBtn = $('.leaflet-draw-draw-marker')[0];\r\n            this.drawPointBtn.click();\r\n        }\r\n        drawOpts.drawPolygonOn = false;\r\n        drawOpts.drawPointOn = false;\r\n    }\r\n\r\n\r\n    toggleDrawLine(type) {\r\n        var drawOpts = this.options.draw;\r\n        drawOpts.drawType = type;\r\n        drawOpts.drawLineOn = !drawOpts.drawLineOn;\r\n        if (!this.drawCancelBtn)\r\n            this.drawCancelBtn = $('.leaflet-draw-actions a').last()[0];\r\n        this.drawCancelBtn && this.drawCancelBtn.click();\r\n        if (drawOpts.drawLineOn) {\r\n            if (!this.drawLineBtn)\r\n                this.drawLineBtn = $('.leaflet-draw-draw-polyline')[0];\r\n            this.drawLineBtn.click();\r\n        }\r\n        drawOpts.drawPolygonOn = false;\r\n        drawOpts.drawPointOn = false;\r\n    }\r\n\r\n    toggleDrawPolygon(type) {\r\n        var drawOpts = this.options.draw;\r\n        drawOpts.drawType = type;\r\n        drawOpts.drawPolygonOn = !drawOpts.drawPolygonOn;\r\n        if (!this.drawCancelBtn)\r\n            this.drawCancelBtn = $('.leaflet-draw-actions a').last()[0];\r\n        this.drawCancelBtn && this.drawCancelBtn.click();\r\n        if (drawOpts.drawPolygonOn) {\r\n            if (!this.drawPolygonBtn)\r\n                this.drawPolygonBtn = $('.leaflet-draw-draw-polygon')[0];\r\n            this.drawPolygonBtn.click();\r\n        }\r\n        drawOpts.drawLineOn = false;\r\n        drawOpts.drawPointOn = false;\r\n    }\r\n\r\n    initDraw(map) {\r\n        var drawPoint = new L.DivIcon({\r\n            iconSize: new L.Point(12, 12),\r\n            className: 'leaflet-div-icon leaflet-editing-icon measure-icon'\r\n        });\r\n        L.Draw.Polyline.prototype.options.icon = drawPoint;\r\n        L.Draw.Polygon.prototype.options.icon = drawPoint;\r\n\r\n        this.orgTips = {\r\n            polyline: L.drawLocal.draw.handlers.polyline.tooltip,\r\n            polygon: L.drawLocal.draw.handlers.polygon.tooltip\r\n        }\r\n\r\n        L.drawLocal.draw.handlers.marker.tooltip = this.drawTip.marker;\r\n        L.drawLocal.draw.handlers.polygon.tooltip = this.drawTip.polygon;\r\n        L.drawLocal.draw.handlers.polyline.tooltip = this.drawTip.polyline;\r\n\r\n        var drawItems = L.featureGroup();\r\n        this.drawItems = drawItems;\r\n        drawItems.addTo(map);\r\n\r\n        var drawControl = new L.Control.Draw({\r\n            draw: {\r\n                polyline: {\r\n                    shapeOptions: {\r\n                        color: 'red',\r\n                        weight: 3\r\n                    }\r\n                },\r\n                polygon: {\r\n                    allowIntersection: false,\r\n                    showArea: false,\r\n                    shapeOptions: {\r\n                        color: 'red',\r\n                        weight: 3\r\n                    }\r\n                },\r\n                marker: {\r\n                    //icon: this.icons.markerlabel\r\n                },\r\n                circle: false,\r\n                rectangle: false\r\n            }\r\n        });\r\n        drawControl.addTo(map);\r\n        this.drawControl = drawControl;\r\n        var cThis = this;\r\n        map.on(L.Draw.Event.CREATED, function (event) {\r\n            var layer = event.layer;\r\n            switch (cThis.options.draw.drawType) {\r\n                case \"measure\":\r\n                    cThis.showMeasureResult(layer);\r\n                    break;\r\n                case \"share\":\r\n                    cThis.showShareResult(layer);\r\n                    break;\r\n                case \"marker\":\r\n                    cThis.showMarkerResult(layer);\r\n                default:\r\n                    break;\r\n            }\r\n        });\r\n    }\r\n\r\n    showMarkerResult(layer) {\r\n        _g.markerPanel.createMarkerOnMap(layer);\r\n    }\r\n\r\n    showShareResult(layer) {\r\n        this.drawItems.addLayer(layer);\r\n        //分享绑定tooltip\r\n        var share = Share.createShare();\r\n        var popup = L.popup().setContent(share.shareDOM);\r\n        share.setState({ layer: layer });\r\n        layer.bindPopup(popup).openPopup();\r\n    }\r\n\r\n    showMeasureResult(layer) {\r\n        var content = this.getMeasureContent(layer);\r\n        var $dom = $('<div class=\"measure-label\">' + content + '<span class=\"iconfont icon-shanchu\"></span></div>');\r\n        $dom.data('layer', layer).find('.iconfont').click(function () {\r\n            var $this = $(this);\r\n            $this.parent().data('layer').remove();\r\n        });\r\n\r\n        this.drawItems.addLayer(layer);\r\n\r\n        var centerMapPoint = layer.getCenter();\r\n        var points = layer.getLatLngs();\r\n\r\n        if (layer instanceof L.Polygon) {\r\n            var ring = points[points.length - 1];\r\n            var lastMapPoint = ring[ring.length - 1];\r\n        } else if (layer instanceof L.Polyline) {\r\n            var lastMapPoint = points[points.length - 1];\r\n        } else { return }\r\n\r\n        if (content !== null) {\r\n            var tooltip = layer.bindTooltip($dom[0], { direction: 'right', permanent: true });\r\n            tooltip.openTooltip(lastMapPoint);\r\n        }\r\n    }\r\n\r\n    showBaselayer(type, showAnno) {\r\n        var layers = this.options.baseLayers;\r\n        this.options.currentBaselayer = type;\r\n\r\n        if (type == 'vec') {\r\n            layers.img.base.remove();\r\n            layers.img.anno.remove();\r\n\r\n            layers.vec.base.addTo(this.map);\r\n            showAnno == false ? layers.vec.anno.remove() : layers.vec.anno.addTo(this.map);\r\n            //layers.vec.anno.setOpacity(showAnno == false ? 0 : 1);\r\n            //layers.vec.base.setOpacity(1);\r\n        } else {\r\n            layers.vec.anno.remove();\r\n            layers.vec.base.remove();\r\n            //layers.img.anno.setOpacity(showAnno == false ? 0 : 1);\r\n            //layers.img.base.setOpacity(1);\r\n\r\n            layers.img.base.addTo(this.map);\r\n            showAnno == false ? layers.img.anno.remove() : layers.img.anno.addTo(this.map);\r\n        }\r\n\r\n        /*\r\n\t\t当前插件存在bug暂时不添加该功能\r\n\r\n\t\tif (!this.minimap) {\r\n\t\t\tthis.minimap = new L.Control.MiniMap(groupLayer, { toggleDisplay: false }).addTo(map);\r\n\t\t} else {\r\n\t\t\tthis.minimap.changeLayer(groupLayer);\r\n\t\t}*/\r\n    }\r\n\r\n    fullExtent() {\r\n        this.map.setView([config.FullExtent.Y, config.FullExtent.X], config.FullExtent.Zoom);\r\n    }\r\n\r\n    loadPOIs(items, fit) {\r\n        var poiItems = this.poiItems;\r\n        poiItems.closePopup();\r\n        this.clearPOILayer();\r\n        var geoJSON = this.POIToGeoJSON(items);\r\n        poiItems.addData(geoJSON);\r\n\r\n        if (fit) {\r\n            var bounds = poiItems.getBounds();\r\n            this.map.fitBounds(bounds, { paddingTopLeft: [400, 50], paddingBottomRight: [50, 50] });\r\n        }\r\n    }\r\n\r\n    _POIToGeoJSON(i) {\r\n        return {\r\n            type: \"Feature\",\r\n            properties: i,\r\n            geometry: {\r\n                type: \"Point\",\r\n                coordinates: [i.X, i.Y]\r\n            }\r\n        };\r\n    }\r\n\r\n    POIToGeoJSON(poi) {\r\n        var geoJSON;\r\n        if (L.Util.isArray(poi)) {\r\n            geoJSON = [];\r\n            for (var i = 0, l = poi.length; i < l; i++) {\r\n                var item = poi[i];\r\n                geoJSON.push(this._POIToGeoJSON(item));\r\n            }\r\n        } else {\r\n            geoJSON = this._POIToGeoJSON(poi);\r\n        }\r\n        return geoJSON;\r\n    }\r\n\r\n    showPOI(item) {\r\n        var ftId = item.FEATUREGUID;\r\n        var icons = this.icons;\r\n        this.getPOILayer(\r\n\t\t\t\tftId,\r\n\t\t\t\tfunction (layer) {\r\n\t\t\t\t    layer.setIcon(icons['poiactive']);\r\n\t\t\t\t    layer.setZIndexOffset(9);\r\n\t\t\t\t},\r\n\t\t\t\tfunction (layer) {\r\n\t\t\t\t    layer.setIcon(icons['poidefault']);\r\n\t\t\t\t    layer.setZIndexOffset(0);\r\n\t\t\t\t});\r\n    }\r\n\r\n    getPOILayer(ftId, layerFun, otherLayerFun) {\r\n        var layers = this.poiItems.getLayers();\r\n        var findLayer = null;\r\n        for (var i = 0, l = layers.length; i < l; i++) {\r\n            var layer = layers[i];\r\n            if (layer.ftId === ftId) {\r\n                findLayer = layer;\r\n                if (layerFun) layerFun(layer);\r\n                if (!otherLayerFun) break;\r\n            } else {\r\n                if (otherLayerFun) otherLayerFun(layer);\r\n            }\r\n        }\r\n    }\r\n\r\n    showPOIDetails(item) {\r\n        var ftId = item.FEATUREGUID;\r\n        var map = this.map;\r\n        this.getPOILayer(\r\n\t\t\t\tftId,\r\n\t\t\t\tfunction (layer) {\r\n\t\t\t\t    map.setView(layer.getLatLng());\r\n\t\t\t\t    layer.openPopup();\r\n\r\n\t\t\t\t});\r\n    }\r\n\r\n    createCorrecting(point, poi_id) {\r\n        var marker = L.marker(point, { icon: this.icons.correcting, zIndexOffset: 99 });\r\n        this.drawItems.addLayer(marker);\r\n        var correcting = Correcting.create(marker, poi_id);\r\n        marker.bindPopup(correcting.dom).openPopup();\r\n    }\r\n\r\n    createAreaSearch(point) {\r\n        var marker = L.marker(point, { zIndexOffset: 99 });\r\n        this.drawItems.addLayer(marker);\r\n        var areaSearch = AreaSearch.create(map, marker);\r\n        areaSearch.popup.openPopup();\r\n    }\r\n\r\n    getPOI(keyword, categories, pagenumber, center, radius) {\r\n        _g.resultsPanel.getPOI(keyword, categories, pagenumber, center, radius);\r\n    }\r\n}\r\n\r\nfunction init() {\r\n    var $window = $(window);\r\n    var $main = $('.main');\r\n    var $map = $main.find('>.map');\r\n    /* toastr setting*/\r\n    (function () {\r\n        toastr.options.positionClass = \"toast-bottom-full-width\";\r\n    })();\r\n\r\n    var urlArgs = commonTool.urlArgs;\r\n\r\n    map = new Map($map[0], urlArgs);\r\n\r\n    function getDOMById(id) {\r\n        return document.getElementById(id);\r\n    }\r\n\r\n\r\n\r\n    function getPOI(item) {\r\n        var keyword = c_searchPanel.state.searchText.trim();\r\n\r\n        var categories = [];\r\n        if (item.sub) {\r\n            for (var i = 0, l = item.sub.length; i < l; i++) {\r\n                var sub = item.sub[i];\r\n                categories = categories.concat(sub.codes);\r\n            }\r\n        } else {\r\n            categories = categories.concat(item.codes);\r\n        }\r\n        c_resultspanel.getPOI(true, keyword, categories);\r\n    }\r\n\r\n    var c_searchPanel = ReactDOM.render(\r\n\t<SearchCategoryPanel btnClick={e=> { c_resultspanel.getPOI(true,e, []); }}\r\n                         click={getPOI}\r\n                         categories={config.SearchCategory\r\n} />, getDOMById('searchPanel'));\r\n\r\n    var c_appcenter = ReactDOM.render(\r\n<AppCenter map={map} windowHeight={$window.height()} layers={config.Layers } />,\r\ngetDOMById('appcenter'));\r\n\r\n    var c_toolbar = ReactDOM.render(\r\n<Toolbar map={map}\r\n         markerLabelPanel={c_appcenter.refs.markerPanel}\r\n         fullExtent={e=>map.fullExtent()}\r\n         clearClick={e=>map.clearAll()}\r\n         sharePointClick={e=>map.toggleDrawPoint('share')}\r\n         shareLineClick={e=>map.toggleDrawLine('share')}\r\n         sharePolygonClick={e=>map.toggleDrawPolygon('share')}\r\n         measureAreaClick={e=>map.toggleDrawPolygon('measure')}\r\n         measureLengthClick={e=>map.toggleDrawLine('measure')}\r\n         baseLayerChange={map.showBaselayer}\r\n         annoLayerChange={map.showBaselayer}\r\n         showServices={e=> { c_appcenter.show('2') }}\r\n         fullScreenDom={$main[0]\r\n} />,\r\ngetDOMById('toolbar'));\r\n\r\n    c_resultspanel = ReactDOM.render(\r\n<SearchResultPanel map={map} url={\"SearchPOI\"}\r\n                   hover={item=>map.showPOI(item)}\r\n                   click={item=>map.showPOIDetails(item)\r\n} />,\r\ngetDOMById('searchresults')\r\n\t\t);\r\n\r\n    var c_nav = ReactDOM.render(<Nav />, getDOMById('nav'));\r\n\r\n    var c_footNav = ReactDOM.render(\r\n<FooterNav navs={config.Navs } />,\r\n\t\tgetDOMById('footernav')\r\n\t);\r\n\r\n    var c_poiDetails = ReactDOM.render(<POIDetailsPanel map={map} onHidden={ e=> {\r\n    if (c_resultspanel.state.hidden && !c_resultspanel.clickHidden)\r\nc_resultspanel.show();\r\n}\r\n} />, getDOMById('poiDetailsPanel'));\r\n\r\n    _g = {\r\n        searchPanel: c_searchPanel,\r\n        appCenter: c_appcenter,\r\n        markerPanel: c_appcenter.refs.markerPanel,\r\n        routePlanning: c_appcenter.refs.routePlanning,\r\n        toolbar: c_toolbar,\r\n        resultsPanel: c_resultspanel,\r\n        nav: c_nav,\r\n        poiDetails: c_poiDetails,\r\n        fun: {\r\n            showError: function (msg) {\r\n                toastr.error(msg);\r\n            },\r\n            showSuccess: function (msg) {\r\n                toastr.success(msg);\r\n            },\r\n            showInfo: function (msg) {\r\n                toastr.info(msg);\r\n            },\r\n            showWarning: function (msg) {\r\n                toastr.warning(msg);\r\n            }\r\n        }\r\n    };\r\n\r\n    var drawPoint = new L.DivIcon({\r\n        iconSize: new L.Point(12, 12),\r\n        className: 'leaflet-div-icon leaflet-editing-icon measure-icon'\r\n    });\r\n    L.Draw.Polyline.prototype.options.icon = drawPoint;\r\n    L.Draw.Polygon.prototype.options.icon = drawPoint;\r\n}\r\n\r\n$(init);"],"names":[],"mappings":"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"}