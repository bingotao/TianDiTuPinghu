{"version":3,"file":"E:\\工作\\Code\\07 天地图·平湖\\TianDiTu-PingHu - 副本\\JXGIS.TianDiTuPinghu.Web\\Extends\\Components\\MapMobile\\MapMobile\\MapMobile.jsx","sourceRoot":null,"sources":["E:\\工作\\Code\\07 天地图·平湖\\TianDiTu-PingHu - 副本\\JXGIS.TianDiTuPinghu.Web\\Extends\\Components\\MapMobile\\MapMobile\\MapMobile.jsx"],"sourcesContent":["antd = window['antd-mobile'];\r\nclass Map {\r\n    constructor(el) {\r\n        var subdomains = ['0', '1', '2', '3', '4', '5', '6', '7'];\r\n        var baseLayers = {\r\n            vec: {\r\n                anno: L.tileLayer(\"http://t{s}.tianditu.cn/DataServer?T=cva_w&X={x}&Y={y}&L={z}\", { subdomains: subdomains, opacity: 1 }),\r\n                base: L.tileLayer(\"http://t{s}.tianditu.cn/DataServer?T=vec_w&X={x}&Y={y}&L={z}\", { subdomains: subdomains, opacity: 1 })\r\n            },\r\n            img: {\r\n                anno: L.tileLayer(\"http://t{s}.tianditu.cn/DataServer?T=cia_w&X={x}&Y={y}&L={z}\", { subdomains: subdomains, opacity: 1 }),\r\n                base: L.tileLayer(\"http://t{s}.tianditu.cn/DataServer?T=img_w&X={x}&Y={y}&L={z}\", { subdomains: subdomains, opacity: 1 })\r\n            }\r\n        };\r\n\r\n        var map = L.map(el, {\r\n            attributionControl: false,\r\n            center: [config.InitPosition.Y, config.InitPosition.X],\r\n            layers: [\r\n\t\t\t\t baseLayers.vec.base,\r\n\t\t\t\t baseLayers.vec.anno,\r\n\t\t\t\t baseLayers.img.base,\r\n\t\t\t\t baseLayers.img.anno\r\n            ],\r\n            zoom: config.InitPosition.Zoom\r\n        });\r\n\r\n        map.zoomControl.setPosition('bottomright');\r\n        L.control.scale({ imperial: false }).setPosition('bottomleft').addTo(map);\r\n\r\n        map.on('click', function (e) {\r\n            var latlng = e.latlng;\r\n            this.getNeareatPOI(latlng, function (poi) {\r\n                if (poi.IsPOI) {\r\n                    cResultPanel.setState({ results: [poi] });\r\n                    cResultPanel.show(true);\r\n                    cResultPanel.addPOIToMap([poi], false);\r\n                    cResultPanel.setActivePOI(poi.FEATUREGUID);\r\n                }\r\n            }.bind(this));\r\n        }, this);\r\n\r\n        this.map = map;\r\n        this.baseLayers = baseLayers;\r\n        this.showBaseMap(\"vec\");\r\n\r\n        this.icons = {\r\n            'default': new L.Icon.Default(),\r\n            'poidefault': L.icon({\r\n                iconUrl:_bl_+ '/Reference/image/poi-default.png',\r\n                iconSize: [24, 38],\r\n                iconAnchor: [12, 38],\r\n                popupAnchor: [0, -38]\r\n            }),\r\n            'poiactive': L.icon({\r\n                iconUrl: _bl_ + '/Reference/image/poi-focus.png',\r\n                iconSize: [24, 38],\r\n                iconAnchor: [12, 38],\r\n                popupAnchor: [0, -38]\r\n            }),\r\n            'startpoint': L.icon({\r\n                iconUrl: _bl_ + '/Reference/image/startpoint.png',\r\n                iconSize: [32, 40],\r\n                iconAnchor: [16, 40],\r\n                popupAnchor: [0, -40],\r\n                zIndexOffset: 999\r\n            }),\r\n            'endpoint': L.icon({\r\n                iconUrl: _bl_ + '/Reference/image/endpoint.png',\r\n                iconSize: [32, 40],\r\n                iconAnchor: [16, 40],\r\n                popupAnchor: [0, -40],\r\n                zIndexOffset: 999\r\n            }),\r\n            'sharepoint': L.icon({\r\n                iconUrl: _bl_ + '/Reference/image/sharepoint.png',\r\n                iconSize: [26, 36],\r\n                iconAnchor: [3, 34],\r\n                popupAnchor: [0, -40]\r\n            })\r\n        };\r\n\r\n        this.location = null;\r\n\r\n        this.route = {\r\n            startPoint: null,\r\n            endPoint: null,\r\n            routes: null\r\n        };\r\n\r\n        var drawItems = L.featureGroup();\r\n        this.drawItems = drawItems;\r\n        drawItems.addTo(map);\r\n    }\r\n\r\n    showBaseMap(type) {\r\n        var layers = this.baseLayers;\r\n        layers.img.base.setOpacity(type === 'vec' ? 0 : 1);\r\n        layers.img.anno.setOpacity(type === 'vec' ? 0 : 1);\r\n        if (type === 'vec') {\r\n            $('.leaflet-control-scale').removeClass('active');\r\n        }\r\n        else {\r\n            $('.leaflet-control-scale').addClass('active');\r\n        }\r\n    }\r\n\r\n    fullAndLockScreen() {\r\n        if (!fullScreenApi.isFullScreen()) {\r\n            fullScreenApi.requestFullScreen(document.getElementById('mapmobile'))\r\n            screen.orientation.lock(\"natural\");\r\n        }\r\n    }\r\n\r\n    clearLocation() {\r\n        this.location ? this.location.remove() : null;\r\n    }\r\n\r\n    getLocation(component, showTip, callback) {\r\n        var cThis = this;\r\n        component && component.showLoading ? component.showLoading() : null;\r\n        if (showTip) { antd.Toast.show(\"定位中...\"); }\r\n        jxgis.geolocation.get(function (rt) {\r\n            x = rt.coords.longitude;\r\n            y = rt.coords.latitude;\r\n\r\n            cThis.clearLocation();\r\n\r\n            var lnglat = L.latLng([y, x]);\r\n            cThis.map.setView(lnglat);\r\n\r\n            var location = L.circleMarker(lnglat, {\r\n                className: 'position-circle',\r\n                weight: 10,\r\n                opacity: 0.2,\r\n                fillOpacity: 1\r\n            }).addTo(cThis.map);\r\n            cThis.location = location;\r\n\r\n            if (showTip) { antd.Toast.success(\"定位成功\"); }\r\n            component && component.hiddenLoading ? component.hiddenLoading(true) : null;\r\n            if (callback) { callback(lnglat); }\r\n        }, function (er) {\r\n            antd.Toast.fail(er.message);\r\n            component && component.hiddenLoading ? component.hiddenLoading() : null;\r\n        });\r\n    }\r\n\r\n    getNeareatPOI(latlng, callBack) {\r\n        $.post('GetNearestPOI',\r\n            {\r\n                lat: latlng.lat,\r\n                lng: latlng.lng\r\n            },\r\n            function (ro) {\r\n                if (ro.ErrorMessage) {\r\n                    antd.Toast.fail(ro.ErrorMessage);\r\n                }\r\n                else {\r\n                    var poi = ro.Data;\r\n                    if (callBack) { callBack(poi); }\r\n                    //if (!poi.IsPOI) {\r\n                    //    poi.SHORTNAME += '（附近）';\r\n                    //}\r\n                }\r\n            }.bind(this), 'json');\r\n    }\r\n\r\n\r\n    setStartPoint(latlng) {\r\n        this.route.startPoint = L.marker(latlng, { icon: this.icons.startpoint }).addTo(this.map);\r\n    }\r\n\r\n    setEndPoint(latlng) {\r\n        this.route.endPoint = L.marker(latlng, { icon: this.icons.endpoint }).addTo(this.map);\r\n    }\r\n\r\n    setRoute(routes) {\r\n        var routes = L.polyline(routes, { color: 'red', opacity: 0.6 }).addTo(this.map);\r\n        this.route.routes = routes;\r\n        this.map.fitBounds(routes.getBounds(), { paddingTopLeft: [0, 60] });\r\n    }\r\n\r\n    clearPlanning() {\r\n        var route = this.route;\r\n        if (route) {\r\n            route.startPoint && route.startPoint.remove();\r\n            route.endPoint && route.endPoint.remove();\r\n            route.routes && route.routes.remove();\r\n        }\r\n    }\r\n\r\n    setPlanning(routePlanning, clear) {\r\n        var rp = routePlanning;\r\n        if (rp) {\r\n            if (clear) {\r\n                this.clearPlanning();\r\n            }\r\n            this.setStartPoint(rp.startPoint);\r\n            this.setEndPoint(rp.endPoint);\r\n            this.setRoute(rp.routes);\r\n        }\r\n    }\r\n\r\n    showMarkerShare(ms) {\r\n        var layer = ms.layer;\r\n        this.drawItems.addLayer(layer);\r\n        var bounds = this.drawItems.getBounds();\r\n        this.map.fitBounds(bounds);\r\n\r\n        var el = document.createElement('div');\r\n        ReactDOM.render(<MarkerShare markerShare={ms } />, el);\r\n\r\n        var popup = L.popup().setContent(el);\r\n        layer.bindPopup(popup).openPopup();\r\n    }\r\n}\r\n\r\nclass MarkerShare extends React.Component {\r\n    constructor(props) {\r\n        super(props);\r\n    }\r\n\r\n    render() {\r\n        var ms = this.props.markerShare;\r\n        return (\r\n        <div className=\"markershare\">\r\n            <h4>标题</h4>\r\n            <div>{ms.title}</div>\r\n            <h4>内容</h4>\r\n            <div>{ms.content}</div>\r\n        </div>);\r\n    }\r\n}\r\n\r\nclass Tools extends React.Component {\r\n    constructor() {\r\n        super();\r\n    }\r\n\r\n    render() {\r\n        var map = this.props.map;\r\n        return (\r\n            <div>\r\n                <BtnLocation ref=\"btnLocation\" map={map} />\r\n                <BtnFullScreen ref=\"btnFullScreen\" map={map} />\r\n                <BtnLayerToggle ref=\"btnLayerToggle\" map={map} />\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\nclass Toolbar extends React.Component {\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = {\r\n            showTools: false\r\n        };\r\n    }\r\n\r\n    toggleShowTools() {\r\n        this.setState({ showTools: !this.state.showTools });\r\n    }\r\n\r\n    render() {\r\n        var s = this.state;\r\n        return (\r\n        <div>\r\n            <span onClick={e => {\r\n                    this.props.onAreaSearchClick();\r\n                }}>\r\n            <span className=\"iconfont icon-zhoubian\"></span>附近\r\n            </span>\r\n            <span onClick={e =>\r\n                {\r\n                    this.props.onRouteClick();\r\n                }}>\r\n            <span className=\"iconfont icon-604luxian\"></span>路线\r\n            </span>\r\n            <span onClick={e=> { this.toggleShowTools(); }}>\r\n                <span className=\"iconfont icon-shezhi\"></span>工具\r\n            </span>\r\n            <ul style={{ display: (s.showTools ? \"block\" : \"none\") }}>\r\n                <li><a href=\"@ViewBag.BaseUrl/Home/Index\"><span className=\"iconfont icon-diannao\"></span>首页</a></li>\r\n                <li onClick={e=> {\r\n                        this.toggleShowTools();\r\n                        var map = this.props.map;\r\n                        map.cResultsPanel.hidden(false, true);\r\n                        map.cRoute.hidden();\r\n                        map.cRoute.clear(true);\r\n                        map.drawItems.clearLayers();\r\n                    }}><span className=\"iconfont icon-qingchu\"></span>清空</li>\r\n            </ul>\r\n        </div>);\r\n    }\r\n}\r\n\r\n$(function () {\r\n    map = new Map(document.getElementById(\"map\"));\r\n\r\n    cOTools = ReactDOM.render(<Tools map={map} />\r\n    , document.getElementById(\"otools\"));\r\n\r\n    cRoute = ReactDOM.render(<RoutePlanning map={map } />, document.getElementById('routeplanning'));\r\n\r\n    cResultPanel = ReactDOM.render(<ResultPanel onGoToHereClick={e=> {\r\n            cRoute.setEndPoint(e);\r\n            cRoute.show();\r\n        }} map={map\r\n    } />, document.getElementById(\"resultpanel\"));\r\n    cSearch = ReactDOM.render(<Search map={map} resultPanel={cResultPanel } />, document.getElementById(\"search\"));\r\n    cAreaSearch = ReactDOM.render(<AreaSearch map={map} resultPanel={cResultPanel} categories={config.SearchCategory } />, document.getElementById(\"areasearch\"));\r\n\r\n    cToolBar = ReactDOM.render(<Toolbar map={map}\r\n                                        onAreaSearchClick={e=> {\r\n            if (map.location) {\r\n                var pnt = map.location.getLatLng();\r\n                cAreaSearch.show(\"当前位置\", { lng: pnt.lng, lat: pnt.lat });\r\n                cResultPanel.target = 'areaSearch';\r\n            } else {\r\n                map.getLocation(null, true, function (latlng) {\r\n                    var pnt = map.location.getLatLng();\r\n                    cAreaSearch.show(\"当前位置\", { lng: pnt.lng, lat: pnt.lat });\r\n                    cResultPanel.target = 'areaSearch';\r\n                }.bind(map));\r\n            }\r\n        }}\r\n                                        onRouteClick={e=> { cRoute.show(false); }\r\n    } />, document.getElementById(\"toolbar\"));\r\n\r\n    $('.mm-title').on('click', e=> {\r\n        cSearch.show(true);\r\n        cResultPanel.hidden(false);\r\n    });\r\n\r\n    map.cToolbar = cToolBar;\r\n    map.cAreaSearch = cAreaSearch;\r\n    map.cSearch = cSearch;\r\n    map.cResultsPanel = cResultPanel;\r\n    map.cRoute = cRoute;\r\n    map.cOTools = cOTools;\r\n    //cOTools.refs.btnLocation.getLocation();\r\n    //$('body').one('click', function () {\r\n    //    if (!fullScreenApi.isFullScreen()) map.fullAndLockScreen();\r\n    //});\r\n\r\n\r\n    //获取url参数\r\n    var urlArgs = commonTool.urlArgs;\r\n    if (urlArgs.markershare) {\r\n        $.post('GetMarkerShare?id=' + urlArgs.markershare, function (rt) {\r\n            if (rt.ErrorMessage) {\r\n                antd.Toast.fail(rt.ErrorMessage);\r\n            } else {\r\n                var ms = rt.Data.MarkerShare;\r\n                var layer = L.GeoJSON.geometryToLayer(JSON.parse(ms.GeoJSON));\r\n                layer.setIcon ? layer.setIcon(map.icons.sharepoint) : null;\r\n                var markerShare = {\r\n                    id: ms.ID,\r\n                    title: ms.Title,\r\n                    content: ms.Content,\r\n                    layer: layer\r\n                };\r\n                map.showMarkerShare(markerShare);\r\n            }\r\n        }, 'json');\r\n    } else if (urlArgs.poishare) {\r\n        $.post('GetPOI?id=' + urlArgs.poishare, function (rt) {\r\n            if (rt.ErrorMessage) {\r\n                antd.Toast.fail(rt.ErrorMessage);\r\n            } else {\r\n                var poi = rt.Data.POI;\r\n                map.map.setView([poi.Y, poi.X]);\r\n                cResultPanel.setState({ results: [poi] });\r\n                cResultPanel.show(true);\r\n                cResultPanel.addPOIToMap([poi], false);\r\n                cResultPanel.setActivePOI(poi.FEATUREGUID);\r\n            }\r\n        }, 'json');\r\n    }\r\n});"],"names":[],"mappings":"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"}